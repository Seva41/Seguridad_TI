#import <Foundation/Foundation.h>
#import <AppKit/AppKit.h>

void mostrarNotificacion(NSString *titulo, NSString *mensaje) {
    NSUserNotification *notification = [[NSUserNotification alloc] init];
    notification.title = titulo;
    notification.informativeText = mensaje;
    [[NSUserNotificationCenter defaultUserNotificationCenter] deliverNotification:notification];
}

int main(int argc, const char * argv[]) {
    @autoreleasepool {
        NSLog(@"¡Has sido infectado por un malware!");
        NSLog(@"Tu sistema ha sido comprometido.");
        NSLog(@"Encriptando tus archivos...");

        // Espera de 2 segundos
        usleep(2000000);

        NSLog(@"Solo bromeo, no te preocupes.");
        NSLog(@"No se ha hecho ningún daño real.");

        // Genera una contraseña
        NSString *password = @"MiContraseña123"; // Reemplaza esto con tu contraseña

        // Crea un archivo de texto con la contraseña en el mismo directorio
        NSString *filePath = [NSString stringWithFormat:@"%@/contrasena.txt", [NSString stringWithUTF8String:argv[0]]];
        [password writeToFile:filePath atomically:YES encoding:NSUTF8StringEncoding error:nil];
        NSLog(@"Se ha creado un archivo 'contrasena.txt' con la contraseña.");

        // Muestra una notificación emergente
        mostrarNotificacion(@"Malware", @"Tu sistema ha sido comprometido.");

        return 0;
    }
}
